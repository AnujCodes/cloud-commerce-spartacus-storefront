<ng-container *ngIf="(updateParams$ | async)">
  <div class="cx-page" *ngIf="(model$ | async) as model">
    <section class="cx-page-section">
      <div class="container">
        <div class="row">
          <div class="col-12 col-lg-12" *ngIf="(gridMode$ | async) as gridMode">
            <div class="cx-sorting top">
              <div class="row">
                <div class="col-4 col-lg-4 cx-sort">
                  <div class="form-group cx-sort-dropdown">
                    <cx-sorting
                      [sortOptions]="model.sorts"
                      (sortListEvent)="sortList($event)"
                      [selectedOption]="model.pagination.sort"
                      placeholder="{{
                        'productList.sortByRelevance' | cxTranslate
                      }}"
                    ></cx-sorting>
                  </div>
                </div>
                <div class="col-12 col-lg-auto cx-pagination">
                  <div
                    class="cx-pagination"
                    aria-label="product search pagination"
                  >
                    <cx-pagination
                      [pagination]="model.pagination"
                      (viewPageEvent)="viewPage($event)"
                    ></cx-pagination>
                  </div>
                </div>
                <div class="col-auto ml-auto ml-lg-0 cx-product-view">
                  <cx-product-view
                    (modeChange)="setGridMode($event)"
                    [mode]="gridMode"
                  ></cx-product-view>
                </div>

                <div class="cx-facet-mobile">
                  <button
                    class="btn btn-action btn-block cx-facet-mobile-btn"
                    (click)="openFilterModal(content)"
                  >
                    {{ 'productList.filterBy.action' | cxTranslate }}
                  </button>
                </div>
              </div>
            </div>
            <div class="cx-product-container">
              <ng-container *ngIf="gridMode === 'grid'">
                <div class="row">
                  <cx-product-grid-item
                    *ngFor="let product of model?.products"
                    [product]="product"
                    class="col-12 col-sm-6 col-md-4"
                  ></cx-product-grid-item>
                </div>
              </ng-container>

              <ng-container *ngIf="gridMode === 'list'">
                <cx-product-list-item
                  *ngFor="let product of model?.products"
                  [product]="product"
                  class="cx-product-search-list"
                ></cx-product-list-item>
              </ng-container>
            </div>
            <div class="cx-sorting bottom">
              <div class="row">
                <div class="col-12 col-lg-4 mr-auto">
                  <div class="form-group cx-sort-dropdown">
                    <cx-sorting
                      [sortOptions]="model.sorts"
                      (sortListEvent)="sortList($event)"
                      [selectedOption]="model.pagination.sort"
                      placeholder="{{
                        'productList.sortByRelevance' | cxTranslate
                      }}"
                    ></cx-sorting>
                  </div>
                </div>
                <div class="col-auto" aria-label="product search pagination">
                  <div class="cx-pagination">
                    <cx-pagination
                      [pagination]="model.pagination"
                      (viewPageEvent)="viewPage($event)"
                    ></cx-pagination>
                  </div>
                </div>
                <div class="col-auto ml-auto ml-lg-0">
                  <cx-product-view
                    (modeChange)="setGridMode($event)"
                    [mode]="gridMode"
                  ></cx-product-view>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</ng-container>

<ng-template #content let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="cx-facet-modal-title" id="modal-title">
      {{ 'productList.filterBy.label' | cxTranslate }}
    </h4>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="d('Cross click')"
    >
      <span aria-hidden="true">
        <cx-icon [type]="iconTypes.TIMES"></cx-icon>
      </span>
    </button>
  </div>
  <div class="modal-body cx-facet-modal-body">
    <form>
      <div
        class="form-group"
        *ngFor="let facet of searchResult.facets; index as facetId"
      >
        <h4 class="cx-facet-modal-label" for="megapixels">{{ facet.name }}</h4>
        <div class="input-group">
          <ul class="cx-facet-list">
            <li *ngFor="let value of facet.values; index as facetValueId">
              <div class="form-check">
                <label class="form-checkbox cx-facet-label">
                  <input
                    class="form-check-input cx-facet-checkbox"
                    role="checkbox"
                    type="checkbox"
                    aria-checked="true"
                    [checked]="value.selected"
                    (change)="toggleValue(value.query.query.value)"
                  />
                  <span class="cx-facet-text"
                    >{{ value.name }} ({{ value.count }})</span
                  >
                </label>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </form>
  </div>
</ng-template>
