<ng-container *ngIf="outOfStock$ | async">
  <ng-container *ngIf="!(anonymous$ | async); else disableNotify">
    <ng-container *ngIf="!(subscribed$ | async); else stopNotify">
      <ng-container *ngIf="prefsEnabled$ | async; else disableNotify">
        <div class="stock-notification-notes">
          <label>Get notified when this product is back in stock.</label>
        </div>
        <button
          class="btn btn-primary btn-block"
          type="button"
          (click)="subscribe()"
        >
          Notify Me
        </button>
      </ng-container>
    </ng-container>
  </ng-container>
</ng-container>

<ng-template #disableNotify>
  <div class="stock-notification-notes">
    <label
      >To get notified when this product is back in stock again please activate
      your Notification Channels.</label
    >
  </div>
  <button class="btn btn-primary btn-block" type="button" disabled="true">
    Notify Me
  </button>
</ng-template>

<ng-template #stopNotify>
  <ng-container *ngIf="!(unsubscribeLoading$ | async); else loading">
    <div class="stock-notification-notes">
      <label>You will be notified when this product is back in stock.</label>
    </div>
    <button
      class="btn btn-primary btn-block"
      type="button"
      (click)="unsubscribe()"
    >
      Stop Notification
    </button>
  </ng-container>
</ng-template>

<ng-template #loading>
  <div class="cx-dialog-body modal-body">
    <div class="cx-dialog-row">
      <div class="col-sm-12">
        <cx-spinner></cx-spinner>
      </div>
    </div>
  </div>
</ng-template>
