<ng-container *ngIf="interests$ | async as interests">
  <div class="container">
    <div class="cx-product-interests-body">
      <ng-container *ngIf="!(getInterestsloading$ | async); else loading">
        <ng-container
          *ngIf="interests.pagination.totalCount > 0; else noInterest"
        >
          <div class="cx-product-interests-sort top row">
            <div
              class="cx-product-interests-form-group form-group col-sm-12 col-md-4 col-lg-4"
            >
              <cx-sorting
                [sortOptions]="sortOptions"
                [sortLabels]="sortLabels"
                (sortListEvent)="sortChange($event)"
                [selectedOption]="sort"
                placeholder="{{ 'myInterests.sortByMostRecent' | cxTranslate }}"
              >
              </cx-sorting>
            </div>
            <div class="cx-product-interests-pagination">
              <cx-pagination
                [pagination]="pagination"
                (viewPageEvent)="pageChange($event)"
              ></cx-pagination>
            </div>
          </div>
          <table class="table cx-product-interests-table">
            <thead class="cx-product-interests-thead-mobile">
              <th scope="col">
                {{ 'myInterests.item' | cxTranslate }}
              </th>
              <th scope="col"></th>
              <th scope="col">
                {{ 'myInterests.price' | cxTranslate }}
              </th>
              <th scope="col">
                {{ 'myInterests.subcriptions' | cxTranslate }}
              </th>
              <th scope="col"></th>
            </thead>
            <tbody>
              <tr
                *ngFor="let result of interests.results"
                class="cx-product-interests-product-item"
              >
                <td>
                  <div class="cx-product-interests-label">
                    <a
                      class="cx-product-interests-product-image-link"
                      [routerLink]="
                        { cxRoute: 'product', params: result.product } | cxUrl
                      "
                    >
                      <cx-media
                        [container]="result.product.images?.PRIMARY"
                        format="thumbnail"
                      ></cx-media>
                    </a>
                  </div>
                </td>
                <td>
                  <div class="cx-info col-10">
                    <div class="cx-info-container row ">
                      <div>
                        <div *ngIf="result.product.name" class="cx-name">
                          <a
                            class="cx-link cx-product-interests-product-code-link"
                            [routerLink]="
                              { cxRoute: 'product', params: result.product }
                                | cxUrl
                            "
                          >
                            {{ result.product.name }}
                          </a>
                        </div>
                        <div *ngIf="result.product.code" class="cx-code">
                          <span>{{
                            'myInterests.productId'
                              | cxTranslate: { code: result.product.code }
                          }}</span>
                        </div>

                        <ng-container
                          *ngFor="let baseOptions of result.product.baseOptions"
                        >
                          <div
                            *ngFor="
                              let variant of baseOptions.selected
                                ?.variantOptionQualifiers
                            "
                            class="cx-property"
                          >
                            <div
                              class="cx-label cx-product-interests-variant-name"
                            >
                              {{ variant.name }}
                            </div>
                            <div
                              class="cx-value cx-product-interests-variant-value"
                            >
                              {{ variant.value }}
                            </div>
                          </div>
                        </ng-container>
                        <div
                          class="cx-property"
                          *ngIf="
                            result.product.stock.stockLevelStatus ===
                            'outOfStock'
                          "
                        >
                          <div
                            class="cx-label cx-product-interests-product-stock"
                          >
                            {{ 'myInterests.outOfStock' | cxTranslate }}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </td>
                <td>
                  <div class="cx-product-interests-product-price">
                    <div class="d-md-none cx-product-interests-label">
                      {{ 'myInterests.price' | cxTranslate }}
                    </div>
                    <span>{{ result.product.price.formattedValue }}</span>
                  </div>
                </td>
                <td>
                  <div class="cx-product-interests-subscriptions">
                    <div class="d-md-none cx-product-interests-label">
                      {{ 'myInterests.subcriptions' | cxTranslate }}
                    </div>
                    <div
                      class="cx-product-interests-notification"
                      *ngFor="let ientry of result.productInterestEntry"
                    >
                      <span class="cx-product-interests-type">
                        {{ ientry.interestType }}
                      </span>
                      <span class="cx-product-interests-expiration-date">
                        {{
                          'myInterests.expirationDate'
                            | cxTranslate
                              : { expirationDate: ientry.expirationDate | date }
                        }}
                      </span>
                    </div>
                  </div>
                </td>
                <td>
                  <div class="cx-product-interests-remove-button">
                    <button
                      type="button"
                      class="close cx-product-interests-remove-btn"
                      aria-label="Close"
                      [class.disabled]="
                        (getInterestsloading$ | async) ||
                        (getRemoveInterestsloading$ | async)
                      "
                      [disabled]="
                        (getInterestsloading$ | async) ||
                        (getRemoveInterestsloading$ | async)
                      "
                      (click)="removeInterest(result)"
                    >
                      <span aria-hidden="true">
                        <cx-icon [type]="iconTypes.CLOSE"></cx-icon
                      ></span>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <!-- Select Form and Pagination Bottom -->
          <div class="cx-product-interests-sort bottom row">
            <div
              class="cx-product-interests-form-group form-group col-sm-12 col-md-4 col-lg-4"
            >
              <cx-sorting
                [sortOptions]="sortOptions"
                [sortLabels]="sortLabels"
                (sortListEvent)="sortChange($event)"
                [selectedOption]="sort"
                placeholder="{{ 'myInterests.sortByMostRecent' | cxTranslate }}"
              >
              </cx-sorting>
            </div>
            <div class="cx-product-interests-pagination">
              <cx-pagination
                [pagination]="pagination"
                (viewPageEvent)="pageChange($event)"
              ></cx-pagination>
            </div>
          </div>
        </ng-container>
      </ng-container>
      <!-- NO ORDER CONTAINER -->
      <ng-template #noInterest>
        <div class="col-sm-12 col-md-6 col-lg-4">
          <div class="cx-product-interests-message">
            {{ 'myInterests.noInterests' | cxTranslate }}
          </div>
        </div>
      </ng-template>
      <ng-template #loading>
        <div class="cx-spinner">
          <cx-spinner></cx-spinner>
        </div>
      </ng-template>
    </div>
  </div>
</ng-container>
